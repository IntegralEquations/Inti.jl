<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Inti.jl</title><meta name="title" content="Home · Inti.jl"/><meta property="og:title" content="Home · Inti.jl"/><meta property="twitter:title" content="Home · Inti.jl"/><meta name="description" content="Documentation for Inti.jl."/><meta property="og:description" content="Documentation for Inti.jl."/><meta property="twitter:description" content="Documentation for Inti.jl."/><meta property="og:url" content="https://IntegralEquations.github.io/Inti.jl/"/><meta property="twitter:url" content="https://IntegralEquations.github.io/Inti.jl/"/><link rel="canonical" href="https://IntegralEquations.github.io/Inti.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Inti.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installing-Julia"><span>Installing Julia</span></a></li><li><a class="tocitem" href="#Installing-Inti.jl"><span>Installing Inti.jl</span></a></li><li><a class="tocitem" href="#Basic-usage"><span>Basic usage</span></a></li><li><a class="tocitem" href="#Contributing"><span>Contributing</span></a></li><li><a class="tocitem" href="#Acknowledgements"><span>Acknowledgements</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="tutorials/getting_started/">Getting started</a></li><li><a class="tocitem" href="tutorials/geo_and_meshes/">Geometry and meshes</a></li><li><a class="tocitem" href="tutorials/integral_operators/">Boundary integral operators</a></li><li><a class="tocitem" href="tutorials/layer_potentials/">Layer potentials</a></li><li><a class="tocitem" href="tutorials/compression_methods/">Compression methods</a></li><li><a class="tocitem" href="tutorials/correction_methods/">Correction methods</a></li><li><a class="tocitem" href="tutorials/solvers/">Solvers</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="examples/generated/toy_example/">Toy example</a></li><li><a class="tocitem" href="examples/generated/helmholtz_scattering/">Helmholtz scattering</a></li><li><a class="tocitem" href="examples/generated/poisson/">Poisson solver</a></li></ul></li><li><a class="tocitem" href="references/">References</a></li><li><a class="tocitem" href="docstrings/">Docstrings</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/IntegralEquations/Inti.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/IntegralEquations/Inti.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Inti"><a class="docs-heading-anchor" href="#Inti">Inti</a><a id="Inti-1"></a><a class="docs-heading-anchor-permalink" href="#Inti" title="Permalink"></a></h1><p><a href="https://IntegralEquations.github.io/Inti.jl/stable/"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Stable"/></a> <a href="https://IntegralEquations.github.io/Inti.jl/dev/"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Dev"/></a> <a href="https://github.com/IntegralEquations/Inti.jl/actions/workflows/CI.yml?query=branch%3Amain"><img src="https://github.com/IntegralEquations/Inti.jl/actions/workflows/CI.yml/badge.svg?branch=main" alt="Build Status"/></a> <a href="https://codecov.io/gh/IntegralEquations/Inti.jl"><img src="https://codecov.io/gh/IntegralEquations/Inti.jl/graph/badge.svg?token=2VF6BR8LA0" alt="codecov"/></a> <a href="https://github.com/JuliaTesting/Aqua.jl"><img src="https://raw.githubusercontent.com/JuliaTesting/Aqua.jl/master/badge.svg" alt="Aqua"/></a></p><p><a href="https://github.com/IntegralEquations/Inti.jl">Inti.jl</a> is a Julia library for the numerical solution of <em>boundary</em> and <em>volume integral equations</em>. It provides routines for <em>assembling</em> and <em>solving</em> the linear systems of equations that arise from applying a <em>Nyström</em> discretization method to an integral equation. The package is designed to be flexible and efficient, and supports the following features:</p><ul><li>Specialized integration routines for computing singular and nearly-singular integrals</li><li>Integrated support for acceleration routines such as the Fast Multipole Method (FMM) and Hierarchical Matrices by the wrapping of external libraries.</li><li>Predefined kernels for some partial differential equations (PDEs) commonly found in mathematical physics such as the Laplace, Helmholtz, and Stokes equations.</li><li>Support for complex geometries in 2D and 3D, either through native parametric representations or by importing complex meshes using <em>Gmsh</em>.</li><li>Efficient construction of complex integral operators from simpler ones through lazy composition.</li></ul><h2 id="Installing-Julia"><a class="docs-heading-anchor" href="#Installing-Julia">Installing Julia</a><a id="Installing-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-Julia" title="Permalink"></a></h2><p>Download of Julia from <a href="https://julialang.org/downloads/">julialang.org</a>, or use <a href="https://github.com/JuliaLang/juliaup">juliaup</a> installer. We recommend using the latest stable version of Julia, although <code>Inti.jl</code> should work with <code>&gt;=v1.6</code>.</p><h2 id="Installing-Inti.jl"><a class="docs-heading-anchor" href="#Installing-Inti.jl">Installing Inti.jl</a><a id="Installing-Inti.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-Inti.jl" title="Permalink"></a></h2><p>Inti.jl is not yet registered in the Julia General registry. You can install it using by launching a Julia REPL and typing the following command:</p><pre><code class="language-julia hljs">using Pkg; Pkg.add(&quot;Inti&quot;; rev = &quot;main&quot;)</code></pre><p>This will download and install the latest version of Inti.jl from the <code>main</code> branch. Change <code>rev</code> if you need a different branch or specific commit hash.</p><h2 id="Basic-usage"><a class="docs-heading-anchor" href="#Basic-usage">Basic usage</a><a id="Basic-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-usage" title="Permalink"></a></h2><p>Inti.jl can be used to solve a variety of linear partial differential equations by recasting them as integral equations. The general workflow for solving a problem consists of the following steps:</p><p class="math-container">\[    \underbrace{\fbox{Geometry} \rightarrow \fbox{Mesh}}_{\textbf{pre-processing}} \rightarrow \fbox{\color{red}{Solver}} \rightarrow \underbrace{\fbox{Visualization}}_{\textbf{post-processing}}\]</p><ul><li><strong>Geometry</strong>: The first step is to define the domain of interest, which can be done using a combination of simple shapes (e.g., circles, rectangles) or more complex <em>CAD</em> models.</li><li><strong>Mesh</strong>: The mesh is a collection of points and segments that approximate the domain. The mesh is used to create a quadrature and discretize the boundary integral equation.</li><li><strong>Solver</strong>: Once a mesh and an accompanying quadrature are available, Inti.jl provides routines for assembling and solving the linear system of equations arising from the discretization of the integral operators. Once found, the solution can be evaluated using an integral representation.</li><li><strong>Visualization</strong>: Finally, the solution can be visualized using a plotting library, such as <code>Makie.jl</code>, or exported to a file for further analysis.</li></ul><p>As a simple example, consider an interior Laplace problem in two dimensions with Dirichlet boundary conditions:</p><p class="math-container">\[\begin{aligned}
\Delta u &amp;= 0 \quad \text{in } \Omega,\\ 
u &amp;= g \quad \text{on } \Gamma,
\end{aligned}\]</p><p>where <span>$\Omega \subset \mathbb{R}^2$</span> is a sufficiently smooth domain, and <span>$\Gamma = \partial \Omega$</span> its boundary. A boundary integral reformulation can be achieved by e.g. searching for the solution <span>$u$</span> in the form of a single-layer potential:</p><p class="math-container">\[u(\boldsymbol{r}) = \int_\Gamma G(\boldsymbol{r},\boldsymbol{y})\sigma(\boldsymbol{y}) \ \mathrm{d}\Gamma(\boldsymbol{y}),\]</p><p>where <span>$\sigma : \Gamma \to \mathbb{R}$</span> is an unknown density function, and <span>$G$</span> is the <a href="https://en.wikipedia.org/wiki/Fundamental_solution">fundamental solution</a> of the Laplace equation. This <em>ansatz</em> is, by construction, an exact solution to the PDE. Imposing the boundary condition on <span>$\Gamma$</span> leads to the following integral equation:</p><p class="math-container">\[    \int_\Gamma G(\boldsymbol{x},\boldsymbol{y})\sigma(\boldsymbol{y}) \ \mathrm{d}\Gamma(\boldsymbol{y}) = g(\boldsymbol{x}) \quad \forall \boldsymbol{x} \in \Gamma,\]</p><p>Formulating the problem above in Inti.jl looks like this:</p><pre><code class="language-julia hljs">using Inti, LinearAlgebra, StaticArrays
# create a geometry
geo = Inti.parametric_curve(0, 1) do s
    return SVector(0.25, 0.0) +
            SVector(cos(2π * s) + 0.65 * cos(4π * s[1]) - 0.65, 1.5 * sin(2π * s))
end
Γ = Inti.Domain(geo)
# create a mesh and quadrature
msh = Inti.meshgen(Γ; meshsize = 0.1)
Q = Inti.Quadrature(msh; qorder = 5)
# create the integral operators
pde = Inti.Laplace(;dim=2)
S, _ = Inti.single_double_layer(;
    pde,
    target = Q,
    source = Q,
    compression = (method = :none,),
    correction = (method = :dim,)
)
# manufacture an exact solution and take its trace on Γ
uₑ = x -&gt; x[1] + x[2] + x[1]*x[2] + x[1]^2 - x[2]^2 + 0.5 * log(norm(x .- SVector(0.5, 1.5))) - 2 * log(norm(x .- SVector(-0.5, -1.5)))
g = map(q -&gt; uₑ(q.coords), Q) # value at quad nodes
# solve for σ
σ = S \ g
# use the single-layer potential to evaluate the solution
𝒮, 𝒟 = Inti.single_double_layer_potential(; pde, source = Q)
uₕ = x -&gt; 𝒮[σ](x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#7 (generic function with 1 method)</code></pre><p>The function <code>uₕ</code> is now a numerical approximation of the solution to the Laplace equation, and can be evaluated at any point in the domain:</p><pre><code class="language-julia hljs">pt = SVector(0.5, 0.1)
println(&quot;Exact value at $pt:   &quot;, uₑ(pt))
println(&quot;Approx. value at $pt: &quot;, uₕ(pt))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Exact value at [0.5, 0.1]:   -0.21152442655333292
Approx. value at [0.5, 0.1]: -0.21152434965444072</code></pre><p>If we care about the solution on the entire domain, we can visualize it using:</p><pre><code class="language-julia hljs">using Meshes, GLMakie # trigger the loading of some Inti extensions
xx = yy = range(-2, 2, length = 100)
fig = Figure()
inside = x -&gt; Inti.isinside(x, Q)
opts = (xlabel = &quot;x&quot;, ylabel = &quot;y&quot;, aspect = DataAspect())
ax1 = Axis(fig[1, 1]; title = &quot;Exact solution&quot;, opts...)
h1 = heatmap!(ax1, xx,yy,(x, y) -&gt; inside((x,y)) ? uₑ((x,y)) : NaN)
viz!(msh; segmentsize = 3)
cb = Colorbar(fig[1, 3], h1)
ax2 = Axis(fig[1, 2]; title = &quot;Approx. solution&quot;, opts...)
h2 = heatmap!(ax2, xx,yy, (x, y) -&gt; inside((x,y)) ? uₕ((x,y)) : NaN, colorrange = cb.limits[])
viz!(msh; segmentsize = 3)</code></pre><img src="index-ceedcdfd.png" alt="Example block output"/><div class="admonition is-info"><header class="admonition-header">Formulation of the problem as an integral equation</header><div class="admonition-body"><p>Given a PDE and boundary conditions, there are often many ways to recast the problem as an integral equation, and the choice of formulation plays an important role in the unique solvability, efficiency, and accuracy of the numerical solution. Inti.jl provides a flexible framework for experimenting with different formulations, but it is up to the user to choose the most appropriate one for their problem.</p></div></div><p>While the example above is a simple one, Inti.jl can handle significantly more complex problems involving multiple domains, heterogeneous coefficients, vector-valued PDEs, three-dimensional geometries, and possibly requiring the use of acceleration techniques such as the Fast Multipole Method. The best way to dive deeper into Inti.jl&#39;s capabilities is the <a href="tutorials/getting_started/#Getting-started">tutorials</a> section. You can also find more advanced usage in the <a href="examples/generated/toy_example/#Toy-example">examples</a> section.</p><h2 id="Contributing"><a class="docs-heading-anchor" href="#Contributing">Contributing</a><a id="Contributing-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing" title="Permalink"></a></h2><h2 id="Acknowledgements"><a class="docs-heading-anchor" href="#Acknowledgements">Acknowledgements</a><a id="Acknowledgements-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgements" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorials/getting_started/">Getting started »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Wednesday 5 June 2024 16:01">Wednesday 5 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
